<!DOCTYPE HTML>
<html>
<head>
  <title><%= title %></title>
  <script src="/javascripts/vis.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <link href="/stylesheets/vis.css" rel="stylesheet" type="text/css" />

  <script type="text/javascript">
    // ... load a visualization
    function loadApps() {
        $.ajax( {url: '/api/apps', success : function (result) {
            data = JSON.parse(result);
            $('select').empty();
            $('select').append("<option>Select one</option>");
            for( app of data) {
                $('select').append("<option value='"+ app.id + "'>" + app.name+ '[by: '+ app.author +']' + "</option>");
            }
        }});
    }

    function loadDot( appid) {
        $.ajax({url: "/api/apps/"+ appid.value, success: function(result) {
            var container = document.getElementById('visualization');
            //console.log(JSON.stringify(data));
            var options = {
                width: "100%",
                height: "800",
                edges: {
                    smooth: {
                        forceDirection: "none",
                        roundness: 1
                    }
                },
                physics: {
                    barnesHut: {
                        damping: 0.07,
                        avoidOverlap: 1
                    },
                    maxVelocity: 0,
                    minVelocity: 0.1,
                    timestep: 0
                },
                interaction:{ 
                    hover: true
                }
            }
            var network = new vis.Network( container, result, options);

            network.on('click', function(params) {
                console.log('click event, getNodeAt returns: ' + JSON.stringify(params, null, 2));
            });
            network.on("showPopup", function (params) {
                console.log('showPopup Event ' + JSON.stringify(params, null,2))
            });
            network.on("hidePopup", function (params) {
                console.log('hidePopup Event' + + JSON.stringify(params, null,2));
            });
        }});
    }
  </script>

</head>
<body onload="loadApps();">
  <p>Application List : 
  <select onchange="loadDot(this)"><option>Application is loading ... Wait...</option></select>
  </p>
  <div id="visualization" height="100%" width="100%"></div>
</body>
</html>